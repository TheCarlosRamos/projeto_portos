<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o de Concess√µes Portu√°rias - Vers√£o Est√°tica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 40;
        }
        .nav-item {
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            background: #3E5FA4;
            color: white;
        }
        .nav-item.active {
            background: #2E4E8C;
            color: white;
        }
        #leaflet-map {
            z-index: 1 !important;
        }
        .leaflet-container {
            z-index: 1 !important;
        }
        .leaflet-popup-pane {
            z-index: 1000 !important;
        }
    </style>
</head>
<body>
<!-- BANNER VERS√ÉO EST√ÅTICA -->
<div style="position: fixed; top: 0; left: 0; right: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 8px; font-size: 12px; z-index: 9999; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    üö¢ Vers√£o Est√°tica - GitHub Pages | Dados atualizados em 02/02/2026 09:44 | 
    <a href="https://github.com/TheCarlosRamos/projeto_portos" target="_blank" style="color: white; text-decoration: underline;">Ver c√≥digo</a>
</div>
<div style="height: 40px;"></div>

<div class="flex h-screen">
    <!-- Sidebar -->
    <div class="sidebar w-64 h-full shadow-xl">
        <div class="p-6">
            <div class="flex items-center gap-3 mb-8">
                <i class="fas fa-ship text-2xl text-blue-600"></i>
                <h1 class="text-xl font-bold text-gray-800">Sistema Portu√°rio</h1>
            </div>
            <nav class="space-y-2">
                <a href="/" class="nav-item active flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700">
                    <i class="fas fa-dashboard"></i>
                    <span>Dashboard</span>
                </a>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <div class="flex-1 overflow-y-auto">
        <div class="min-h-screen pb-12">
            <!-- Header -->
            <div class="bg-white shadow-md">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                    <h1 class="text-3xl font-bold text-gray-800">Gest√£o de Concess√µes Portu√°rias</h1>
                    <p class="text-gray-600 mt-2">Acompanhamento de Projetos de Concess√£o</p>
                </div>
            </div>

            <!-- Main Content -->
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <!-- Mapa de Projetos -->
                <div class="mb-8">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-map-marked-alt text-blue-600"></i>
                            Mapa de Projetos Portu√°rios
                        </h2>
                        <div class="mb-4">
                            <div id="projects-map" class="w-full h-96 min-h-[400px] rounded-lg overflow-hidden">
                                <!-- Mapa ser√° inserido aqui -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Search and Filter -->
                <div class="mb-6 flex gap-4">
                    <div class="relative flex-1">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text" id="search-input" 
                               class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500" 
                               placeholder="Buscar projetos...">
                    </div>
                </div>

                <!-- Projects Grid -->
                <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cards ser√£o inseridos aqui via JavaScript -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div id="project-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50">
    <div id="modal-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-y-auto">
        <div class="p-6">
            <div class="flex items-center justify-between mb-6">
                <h2 id="modal-title" class="text-2xl font-bold text-gray-800"></h2>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="modal-body" class="flex flex-wrap justify-center"></div>
        </div>
    </div>
</div>

<script>
// Dados dos projetos - Gerado em 02/02/2026 09:44:00
const projetosData = [
  {
    "id": "projeto-0",
    "zona": "Porto Organizado de Santos",
    "uf": "SP",
    "objConcessao": "TECON 10",
    "tipo": "Arrendamento",
    "descricao": "Terminal destinado √† movimenta√ß√£o e armazenagem de carga conteinerizada e carga geral.",
    "capexTotal": 6454903000,
    "capexExecutado": 40473675.0,
    "progresso": 0.63,
    "coordenadasLatLon": {
      "lat": -23.926132,
      "lon": -46.34027
    },
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  },
  {
    "id": "projeto-1",
    "zona": "N√£o se aplica",
    "uf": "MT; MS",
    "objConcessao": "Hidrovia do Paraguai",
    "tipo": "Concess√£o",
    "descricao": "Hidrovia no trecho brasileiro fazendo divisa com Paraguai e Bol√≠via.",
    "capexTotal": 63796000,
    "capexExecutado": null,
    "progresso": 0,
    "coordenadasLatLon": null,
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  },
  {
    "id": "projeto-2",
    "zona": "Porto Organizado de Macei√≥",
    "uf": "AL",
    "objConcessao": "TPM Mac√©io",
    "tipo": "Arrendamento",
    "descricao": "Terminal destinado a movimenta√ß√£o de passageiros.",
    "capexTotal": 1978000,
    "capexExecutado": null,
    "progresso": 0,
    "coordenadasLatLon": null,
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  },
  {
    "id": "projeto-3",
    "zona": "Porto Organizado do Rio de Janeiro",
    "uf": "RJ",
    "objConcessao": "RDJ07",
    "tipo": "Arrendamento",
    "descricao": "Terminal para movimenta√ß√£o de ve√≠culos e carga geral.",
    "capexTotal": 101741000,
    "capexExecutado": null,
    "progresso": 0,
    "coordenadasLatLon": null,
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  },
  {
    "id": "projeto-4",
    "zona": "Porto Organizado de Paranagu√°",
    "uf": "PR",
    "objConcessao": "TECON PARANAGU√Å",
    "tipo": "Arrendamento",
    "descricao": "Terminal especializado em cont√™ineres com moderna infraestrutura.",
    "capexTotal": 2500000000,
    "capexExecutado": 125000000,
    "progresso": 5.0,
    "coordenadasLatLon": {
      "lat": -25.5255,
      "lon": -48.5146
    },
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  },
  {
    "id": "projeto-5",
    "zona": "Porto Organizado de Itaja√≠",
    "uf": "SC",
    "objConcessao": "Terminal Itaja√≠",
    "tipo": "Arrendamento",
    "descricao": "Terminal multiprop√≥sito para cont√™ineres e carga geral.",
    "capexTotal": 850000000,
    "capexExecutado": 42500000,
    "progresso": 5.0,
    "coordenadasLatLon": {
      "lat": -26.9134,
      "lon": -48.6721
    },
    "dataAssinatura": null,
    "etapa": "Em Andamento"
  }
];

let projetosFiltrados = [...projetosData];
let currentProject = null;

// Carregar dados ao iniciar
function loadData() {
    console.log('Carregando dados embutidos:', projetosData.length, 'projetos');
    projetosFiltrados = [...projetosData];
    
    // Gera o mapa de projetos
    generateProjectsMap(projetosData);
    
    renderProjects();
    console.log('Dados carregados:', projetosData.length, 'projetos');
}

// Renderizar cards de projetos
function renderProjects() {
    const grid = document.getElementById('projects-grid');
    
    if (projetosFiltrados.length === 0) {
        grid.innerHTML = '<div class="col-span-full text-center text-white p-8"><p>Nenhum projeto encontrado.</p></div>';
        return;
    }

    grid.innerHTML = projetosFiltrados.map(projeto => {
        const statusColor = projeto.progresso === 0 ? 'bg-gray-400' : 
                           projeto.progresso < 50 ? 'bg-yellow-500' : 
                           projeto.progresso < 100 ? 'bg-blue-500' : 'bg-green-500';
        
        return `
            <div data-id="${projeto.id}" class="project-card bg-white rounded-xl shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow">
                <div>
                    <p class="text-sm text-gray-500">${projeto.uf}</p>
                    <h3 class="text-lg font-bold mt-1 text-gray-800">${projeto.objConcessao || 'Obj. de concess√£o n√£o informado'}</h3>
                    <p class="text-sm text-gray-600 mt-2 line-clamp-3">${projeto.descricao || 'Descri√ß√£o n√£o dispon√≠vel'}</p>
                </div>
                <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-200">
                    <div class="flex items-center">
                        <span class="w-3 h-3 rounded-full ${statusColor} mr-2"></span>
                        <span class="text-sm font-medium text-gray-600">${projeto.etapa}</span>
                    </div>
                    ${projeto.capexTotal > 0 ? `
                        <span class="text-xs text-gray-500">
                            R$ ${(projeto.capexTotal / 1000000).toFixed(1)}M
                        </span>
                    ` : ''}
                </div>
                ${projeto.progresso > 0 ? `
                    <div class="mt-3">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${projeto.progresso}%"></div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">${projeto.progresso.toFixed(1)}% conclu√≠do</p>
                    </div>
                ` : ''}
            </div>
        `;
    }).join('');
}

// Gerar mapa de projetos
function generateProjectsMap(projects) {
    const mapContainer = document.getElementById('projects-map');
    if (!mapContainer) return;
    
    // Filtrar projetos com coordenadas
    const projectsWithCoords = projects.filter(p => p.coordenadasLatLon);
    
    if (projectsWithCoords.length === 0) {
        mapContainer.innerHTML = `
            <div class="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center">
                <div class="text-center">
                    <i class="fas fa-map-marked-alt text-4xl text-gray-400 mb-2"></i>
                    <p class="text-gray-500">Nenhum projeto com coordenadas dispon√≠veis</p>
                </div>
            </div>
        `;
        return;
    }
    
    // Criar mapa interativo com Leaflet
    mapContainer.innerHTML = '<div id="leaflet-map" style="width: 100%; height: 100%; border-radius: 0.5rem;"></div>';
    
    // Inicializa o mapa do Brasil
    const map = L.map('leaflet-map').setView([-14.235, -51.925], 4);
    
    // Adiciona camada do OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);
    
    // Array para armazenar todos os marcadores
    const markers = [];
    
    // Adiciona marcadores para cada projeto
    projectsWithCoords.forEach(p => {
        const lat = p.coordenadasLatLon.lat;
        const lon = p.coordenadasLatLon.lon;
        const nome = p.objConcessao || p.nome || 'Projeto';
        const uf = p.uf || '';
        const descricao = p.descricao || '';
        
        // Cria popup com informa√ß√µes do projeto
        const popupContent = `
            <div style="min-width: 200px;">
                <h4 style="margin: 0 0 8px 0; color: #2E4E8C; font-weight: bold;">${nome}</h4>
                ${uf ? `<p style="margin: 4px 0; color: #666;"><strong>UF:</strong> ${uf}</p>` : ''}
                ${descricao ? `<p style="margin: 4px 0; color: #666; font-size: 12px;">${descricao.substring(0, 100)}${descricao.length > 100 ? '...' : ''}</p>` : ''}
                <p style="margin: 8px 0 0 0; color: #999; font-size: 11px;">Lat: ${lat.toFixed(6)}, Lon: ${lon.toFixed(6)}</p>
            </div>
        `;
        
        // Cria marcador personalizado
        const marker = L.marker([lat, lon]).addTo(map);
        marker.bindPopup(popupContent);
        markers.push(marker);
    });
    
    // Ajusta o mapa para mostrar todos os marcadores
    if (markers.length > 0) {
        const group = new L.featureGroup(markers);
        map.fitBounds(group.getBounds().pad(0.1));
    }
}

// Event Listeners
function addEventListeners() {
    // Fechar modal
    const closeModal = document.getElementById('close-modal');
    const modal = document.getElementById('project-modal');
    
    if (closeModal && modal) {
        closeModal.addEventListener('click', () => {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });
    }
    
    // Clicar nos cards
    document.addEventListener('click', (e) => {
        const card = e.target.closest('.project-card');
        if (card) {
            const projectId = card.dataset.id;
            renderProjectDetails(projectId);
        }
    });
    
    // Busca
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            projetosFiltrados = projetosData.filter(projeto => 
                projeto.objConcessao.toLowerCase().includes(searchTerm) ||
                projeto.descricao.toLowerCase().includes(searchTerm) ||
                projeto.uf.toLowerCase().includes(searchTerm)
            );
            renderProjects();
        });
    }
}

// Renderizar detalhes do projeto
function renderProjectDetails(projectId) {
    const project = projetosData.find(p => p.id === projectId);
    if (!project) return;
    
    currentProject = project;
    
    const modal = document.getElementById('project-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    
    if (!modal || !modalTitle || !modalBody) return;
    
    const zona = project.zona || 'N√£o informado';
    const obj = project.objConcessao || '';
    const nomeProjeto = zona === 'N√£o se aplica' ? obj : `${zona} - ${obj}`;
    
    modalTitle.textContent = nomeProjeto;
    
    modalBody.innerHTML = `
        <div class="w-full max-w-4xl">
            <div class="bg-gray-50 rounded-xl p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fas fa-info-circle text-blue-600"></i>
                    Informa√ß√µes do Projeto
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <span class="text-sm font-medium text-gray-600">Zona Portu√°ria:</span>
                        <span class="text-gray-800 ml-2">${project.zona || 'N√£o se aplica'}</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium text-gray-600">UF:</span>
                        <span class="text-gray-800 ml-2">${project.uf || '-'}</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium text-gray-600">Objeto de Concess√£o:</span>
                        <span class="text-gray-800 ml-2">${project.objConcessao || '-'}</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium text-gray-600">Tipo:</span>
                        <span class="text-gray-800 ml-2">${project.tipo || '-'}</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium text-gray-600">CAPEX Total:</span>
                        <span class="text-gray-800 ml-2">R$ ${(project.capexTotal / 1000000).toFixed(1)}M</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium text-gray-600">Progresso:</span>
                        <span class="text-gray-800 ml-2">${project.progresso.toFixed(1)}%</span>
                    </div>
                </div>
                ${project.descricao ? `
                    <div class="mt-4">
                        <span class="text-sm font-medium text-gray-600">Descri√ß√£o:</span>
                        <p class="text-gray-800 mt-1">${project.descricao}</p>
                    </div>
                ` : ''}
            </div>
        </div>
    `;
    
    modal.classList.remove('hidden');
    modal.classList.add('flex');
}

// Inicializar quando o DOM estiver carregado
document.addEventListener('DOMContentLoaded', () => {
    loadData();
    addEventListeners();
});
</script>
</body>
</html>
